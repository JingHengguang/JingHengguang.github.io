{"version":3,"sources":["webpack:///./src/views/editavatar.vue?4a70","webpack:///./src/views/editavatar.vue?6e9f","webpack:///src/views/editavatar.vue","webpack:///./src/views/editavatar.vue?4830","webpack:///./src/views/editavatar.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","handleCancel","_v","AvatarUrl","staticStyle","uploadAvatarUrl","limit","handlePictureCardPreview","handleRemove","handleAvatarSuccess","beforeAvatarUpload","handleExceed","imgUploadError","dialogVisibleImg","$event","dialogImageUrl","handleSave","staticRenderFns","component"],"mappings":"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","file":"js/chunk-3ba26866.0ec1e653.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editavatar.vue?vue&type=style&index=0&id=3001619a&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"fullUser\"},[_c('el-button',{attrs:{\"type\":\"success\",\"plain\":\"\",\"icon\":\"el-icon-arrow-left\"},on:{\"click\":_vm.handleCancel}},[_vm._v(\"返回主页\")]),_c('div',{staticClass:\"userinfo\"},[_c('el-form',{attrs:{\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"原头像:\"}},[_c('img',{staticClass:\"updateAvatarFile\",attrs:{\"src\":_vm.AvatarUrl,\"alt\":\"头像加载失败...\"}})]),_c('el-form-item',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"label\":\"新头像：\",\"label-width\":\"100px\"}},[_c('el-upload',{attrs:{\"list-type\":\"picture-card\",\"action\":_vm.uploadAvatarUrl,\"auto-upload\":true,\"limit\":_vm.limit,\"multiple\":false,\"show-file-list\":true,\"on-preview\":_vm.handlePictureCardPreview,\"on-remove\":_vm.handleRemove,\"on-success\":_vm.handleAvatarSuccess,\"before-upload\":_vm.beforeAvatarUpload,\"on-exceed\":_vm.handleExceed,\"on-error\":_vm.imgUploadError}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),_c('el-form-item',[_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisibleImg},on:{\"update:visible\":function($event){_vm.dialogVisibleImg=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})])],1)],1)],1),_c('div',{staticClass:\"btn\"},[_c('el-button',{staticStyle:{\"font-size\":\"20px\"},attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":_vm.handleSave}},[_vm._v(\" 确 定 \"),_c('i',{staticClass:\"el-icon-arrow-right el-icon--right\"})])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\r\n    <div class=\"fullUser\">\r\n        <el-button type=\"success\" plain icon=\"el-icon-arrow-left\" @click=\"handleCancel\">返回主页</el-button>\r\n        <div class=\"userinfo\">\r\n            <!-- 头像 -->\r\n            <el-form label-width=\"100px\">\r\n                <el-form-item label=\"原头像:\">\r\n                    <img class=\"updateAvatarFile\" :src=\"AvatarUrl\" alt=\"头像加载失败...\">\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"新头像：\" label-width=\"100px\" style=\"margin-top: 20px\">\r\n                    <el-upload list-type=\"picture-card\" :action=\"uploadAvatarUrl\" :auto-upload=\"true\" :limit=\"limit\"\r\n                        :multiple=\"false\" :show-file-list=\"true\" :on-preview=\"handlePictureCardPreview\"\r\n                        :on-remove=\"handleRemove\" :on-success=\"handleAvatarSuccess\" :before-upload=\"beforeAvatarUpload\"\r\n                        :on-exceed=\"handleExceed\" :on-error=\"imgUploadError\">\r\n\r\n                        <i class=\"el-icon-plus\"></i>\r\n                    </el-upload>\r\n                </el-form-item>\r\n\r\n                <el-form-item>\r\n                    <el-dialog :visible.sync=\"dialogVisibleImg\">\r\n                        <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n                    </el-dialog>\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n\r\n        <div class=\"btn\">\r\n            <el-button type=\"primary\" plain @click=\"handleSave\" style=\"font-size: 20px;\">\r\n                确 定\r\n                <i class=\"el-icon-arrow-right el-icon--right\"></i>\r\n            </el-button>\r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n\r\n<script>\r\nimport router from \"../../router\";\r\nimport { getUserId } from \"../utils/auth\";\r\nimport { modUser, getUserById } from \"../api/users\"\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            //上传图片接口地址\r\n            uploadAvatarUrl: 'http://localhost:5000/files/uploadAvatar/',\r\n            //点击查看图片弹框\r\n            dialogVisibleImg: false,\r\n            //点击图片查看，本地图片路径\r\n            dialogImageUrl: '',\r\n            //获取头像接口地址\r\n            baseUrl: \"http://localhost:5000/files/avatarPath?avatarUrl=\",\r\n            //最大上传数量\r\n            limit: 1,\r\n            //当前头像地址\r\n            currentAvatarUrl: \"UploadFiles\\\\DefaultImage\\\\default.jpg\",\r\n\r\n            //个人信息数据\r\n            formData: {\r\n                currentId: 0,\r\n                username: \"\",\r\n                password: \"\",\r\n                userRoleId: 0,\r\n                avatarUrl: \"\",\r\n                remarks: \"\",\r\n            },\r\n\r\n        };\r\n    },\r\n    //函数\r\n    methods: {\r\n        //刷新用户信息\r\n        refUserInfo() {\r\n\r\n            //获取到当前用户的信息 \r\n            getUserById(this.formData.currentId)\r\n                .then((res) => {\r\n                    if (res.code == 200) {\r\n                        console.log(res);\r\n\r\n                        this.formData.username = res.data.username;\r\n                        this.formData.userRoleId = res.data.userRoleId;\r\n                        this.formData.remarks = res.data.remarks;\r\n                        this.currentAvatarUrl = res.data.avatarUrl;\r\n                        this.formData.password = res.data.password;\r\n                        console.log(this.formData);\r\n                        console.log(\"刷新成功\");\r\n                    }\r\n\r\n                })\r\n                .catch((err) => {\r\n                    console.log(\"调用失败：---\\n\" + err);\r\n                })\r\n        },\r\n        // 点击查看预览图片\r\n        handlePictureCardPreview(file) { //预览图片时调用\r\n            console.log(\"预览图片\");\r\n            console.log(file);\r\n\r\n            this.dialogImageUrl = file.url;\r\n            this.dialogVisibleImg = true;\r\n        },\r\n        // 点击删除头像\r\n        handleRemove(file, fileList) { //移除图片\r\n            console.log(\"删除头像\");\r\n            console.log(fileList);\r\n            this.formData.avatarUrl = \"\";\r\n        },\r\n        // 图片上传之前事件\r\n        beforeAvatarUpload(file) { //文件上传之前调用做一些拦截限制\r\n            console.log(\"图片上传之前事件\");\r\n            console.log(file);\r\n\r\n            const isJPG = file.type === \"image/jpeg\";\r\n            const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n            if (!isJPG) {\r\n                this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n            }\r\n            if (!isLt2M) {\r\n                this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n            }\r\n            return isJPG && isLt2M;\r\n        },\r\n        //图片上传成功\r\n        handleAvatarSuccess(res, file) {\r\n\r\n            this.dialogImageUrl = URL.createObjectURL(file.raw);\r\n            if (res.code == 200) {\r\n                this.$message.success('图片上传成功!');\r\n                this.formData.avatarUrl = res.data\r\n\r\n            } else {\r\n                this.$message.error('图片上传失败，请重新上传！');\r\n            }\r\n        },\r\n        //图片上传超过数量限制\r\n        handleExceed(file, fileList) {\r\n            console.log(fileList);\r\n            this.$message.error('只能上传一张头像哦，请删除前一张后重试');\r\n        },\r\n        //图片上传失败调用\r\n        imgUploadError(err, file, fileList) {\r\n            console.log(\"图片上传失败调用\");\r\n            console.log(err);\r\n            console.log(file);\r\n            console.log(fileList);\r\n            this.$message.error('上传图片失败!');\r\n        },\r\n        ///个人信息取消按钮\r\n        handleCancel() {\r\n            router.push(\"/home\");\r\n        },\r\n        ///个人信息确定按钮\r\n        handleSave() {\r\n\r\n            console.log(this.formData);\r\n\r\n            if (this.formData.avatarUrl == \"\") {\r\n                this.$message({ type: \"error\", message: \"请上传一张头像\" });\r\n                return;\r\n            }\r\n\r\n\r\n\r\n            modUser(this.formData.currentId, this.formData)\r\n                .then((res) => {\r\n                    console.log(res);\r\n                    //  this.$router.go(0);\r\n                    this.$router.push(\r\n                        {\r\n                            name: \"layout\",\r\n                            params: {\r\n                               avatarUrl:this.formData.avatarUrl\r\n                            }\r\n                        });\r\n\r\n                    // router.push(\"/home\");\r\n                    this.$message({ type: \"success\", message: res.msg });\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n\r\n        },\r\n\r\n    },\r\n\r\n    computed: {\r\n        //头像地址'\r\n        AvatarUrl() {\r\n            var avatarFullUrl = this.baseUrl + this.currentAvatarUrl;\r\n\r\n            return avatarFullUrl;\r\n        },\r\n    },\r\n    //页面数据加载完毕执行\r\n    mounted() {\r\n        //获取当前用户\r\n        this.formData.currentId = getUserId();\r\n        this.refUserInfo(this.formData.currentId);\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.fullUser {\r\n    height: 100%;\r\n    background-color: plum;\r\n    font-weight: bold;\r\n}\r\n\r\n.userinfo {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.updateAvatarFile {\r\n    width: 150px;\r\n    height: 150px;\r\n    margin-top: 15px;\r\n}\r\n\r\n.btn {\r\n    display: flex;\r\n    justify-content: center;\r\n    margin-top: 30px;\r\n\r\n}\r\n\r\n.btn>.el-button {\r\n    width: 300px;\r\n    text-align: center;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editavatar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editavatar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./editavatar.vue?vue&type=template&id=3001619a&scoped=true&\"\nimport script from \"./editavatar.vue?vue&type=script&lang=js&\"\nexport * from \"./editavatar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./editavatar.vue?vue&type=style&index=0&id=3001619a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3001619a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}